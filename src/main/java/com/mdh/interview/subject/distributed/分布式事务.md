# 分布式事务

~~~
在分布式系统中一次操作需要由多个服务协同完成，这种由不同的服务之间通过网络协同完成的事务称为分布式事务
https://www.cnblogs.com/chengxy-nds/p/14046856.html
https://blog.csdn.net/a745233700/article/details/122402303
~~~

## 解决方案
~~~
1.本地消息表
2.消息队列：
    目前RocketMQ中支持事务消息
    a.生产者订单系统先发送一条half消息到broker，half消息对消费者而言是不可见的
    b.在创建订单，根据创建订单成功与否，向Broker发送commit或者rollback
    c.并且生产者订单系统还可以提供Broker回调接口，当Broker发现一段时half消息没有收到任何操作命令，则会主动调用此接口来查询订单是否创建成功
    d.一旦half消息commit了，消费者库存系统就会来消费，如果消费成功，则消息撤销，分布式事务成功结束
    e.如果消费失败，则根据重试策略进行重试，最后还失败则进入死信队列，等待进一步处理
3.seata：阿里开源的分布式事务框架，支持AT、TCC等多种模式，底层都是基于两阶段提交理论来实现的
~~~