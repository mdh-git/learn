package com.mdh.algorithm;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.stream.Collectors;

/**
 * DESCRIPTION: TODO
 *
 * @author donghao.ma
 * @date 2019/5/20 10:32
 */
public class JiaYouTest {

    public static void main(String[] args) throws ParseException {
        
        String[] array = getData();
        getResult(array);
    }

    private static void getResult(String[] array) throws ParseException {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd HH:mm");
        //给出时间的个数
        int length = array.length;
        //原有时间的数据
        List<Gas> list = new ArrayList<>(length);
        for (int i = 0; i < length; i++) {
            list.add(new Gas(i, sdf.parse(array[i]), 1));
        }
        //多少辆车
        int j = 1;
        //时间不是被删除的
        list = list.stream().filter(x -> x.getIsAble().equals(1)).collect(Collectors.toList());
        while (list.size() > 0){
            System.out.println("第" + j + "辆车:");
            for (int i = 0; i < length;){
                int k = i;
                Gas gasi;
                if(k == 0){
                    gasi = list.get(0);
                } else {
                    gasi = list.stream().filter(x -> x.getId().equals(k)).findFirst().orElse(null);
                }
                gasi.setIsAble(0);
                System.out.println(gasi.id + ":" + sdf.format(gasi.getTime()) + "  ");
                list = list.stream().filter(x -> x.getIsAble().equals(1)).collect(Collectors.toList());
                Gas gas = list.stream().filter(x -> x.getTime().getTime() >= getAfterAnHour(gasi.getTime())).findFirst().orElse(null);
                if(gas == null){
                    break;
                }
                i = gas.id;
                continue;
            }
            list = list.stream().filter(x -> x.getIsAble().equals(1)).collect(Collectors.toList());
            j++;
        }
    }

    /**
     * 去数据
     * @return
     */
    private static String[] getData() {
        String[] array = {
                "2012/9/21 6:45",
                "2012/9/21 6:45",
                "2012/9/21 6:45",
                "2012/9/21 6:50",
                "2012/9/21 6:50",
                "2012/9/21 6:50",
                "2012/9/21 6:50",
                "2012/9/21 6:55",
                "2012/9/21 6:55",
                "2012/9/21 7:00",
                "2012/9/21 7:10",
                "2012/9/21 7:15",
                "2012/9/21 7:15",
                "2012/9/21 7:15",
                "2012/9/21 7:25",
                "2012/9/21 7:25",
                "2012/9/21 7:30",
                "2012/9/21 7:30",
                "2012/9/21 7:35",
                "2012/9/21 7:35",
                "2012/9/21 7:35",
                "2012/9/21 7:40",
                "2012/9/21 7:40",
                "2012/9/21 7:40",
                "2012/9/21 7:45",
                "2012/9/21 7:45",
                "2012/9/21 7:45",
                "2012/9/21 7:50",
                "2012/9/21 7:50",
                "2012/9/21 7:55",
                "2012/9/21 7:55",
                "2012/9/21 7:55",
                "2012/9/21 8:00",
                "2012/9/21 8:05",
                "2012/9/21 8:05",
                "2012/9/21 8:10",
                "2012/9/21 8:10",
                "2012/9/21 8:15",
                "2012/9/21 8:15",
                "2012/9/21 8:20",
                "2012/9/21 8:20",
                "2012/9/21 8:20",
                "2012/9/21 8:25",
                "2012/9/21 8:25",
                "2012/9/21 8:30",
                "2012/9/21 8:30",
                "2012/9/21 8:35",
                "2012/9/21 8:35",
                "2012/9/21 8:40",
                "2012/9/21 8:45",
                "2012/9/21 8:45",
                "2012/9/21 8:45",
                "2012/9/21 8:50",
                "2012/9/21 8:55",
                "2012/9/21 8:55",
                "2012/9/21 8:55",
                "2012/9/21 8:55",
                "2012/9/21 9:00",
                "2012/9/21 9:00",
                "2012/9/21 9:00",
                "2012/9/21 9:05",
                "2012/9/21 9:05",
                "2012/9/21 9:05",
                "2012/9/21 9:05",
                "2012/9/21 9:10",
                "2012/9/21 9:25",
                "2012/9/21 9:25",
                "2012/9/21 9:30",
                "2012/9/21 9:55",
                "2012/9/21 9:55",
                "2012/9/21 10:00",
                "2012/9/21 10:15",
                "2012/9/21 10:20",
                "2012/9/21 10:20",
                "2012/9/21 10:25",
                "2012/9/21 10:25",
                "2012/9/21 10:30",
                "2012/9/21 10:30",
                "2012/9/21 10:30",
                "2012/9/21 10:35",
                "2012/9/21 10:40",
                "2012/9/21 10:40",
                "2012/9/21 10:45",
                "2012/9/21 10:45",
                "2012/9/21 10:50",
                "2012/9/21 10:50",
                "2012/9/21 10:50",
                "2012/9/21 10:50",
                "2012/9/21 10:50",
                "2012/9/21 10:55",
                "2012/9/21 10:55",
                "2012/9/21 11:00",
                "2012/9/21 11:05",
                "2012/9/21 11:05",
                "2012/9/21 11:05",
                "2012/9/21 11:20",
                "2012/9/21 11:25",
                "2012/9/21 11:25",
                "2012/9/21 11:30",
                "2012/9/21 11:30",
                "2012/9/21 11:30",
                "2012/9/21 11:40",
                "2012/9/21 11:40",
                "2012/9/21 11:40",
                "2012/9/21 11:40",
                "2012/9/21 11:40",
                "2012/9/21 11:50",
                "2012/9/21 11:50",
                "2012/9/21 11:50",
                "2012/9/21 11:55",
                "2012/9/21 12:00",
                "2012/9/21 12:00",
                "2012/9/21 12:05",
                "2012/9/21 12:10",
                "2012/9/21 12:30",
                "2012/9/21 12:35",
                "2012/9/21 12:40",
                "2012/9/21 12:40",
                "2012/9/21 12:45",
                "2012/9/21 12:50",
                "2012/9/21 12:55",
                "2012/9/21 12:55",
                "2012/9/21 12:55",
                "2012/9/21 13:00",
                "2012/9/21 13:00",
                "2012/9/21 13:00",
                "2012/9/21 13:00",
                "2012/9/21 13:10",
                "2012/9/21 13:20",
                "2012/9/21 13:25",
                "2012/9/21 13:30",
                "2012/9/21 13:40",
                "2012/9/21 13:40",
                "2012/9/21 13:50",
                "2012/9/21 13:55",
                "2012/9/21 14:00",
                "2012/9/21 14:00",
                "2012/9/21 14:05",
                "2012/9/21 14:05",
                "2012/9/21 14:15",
                "2012/9/21 14:20",
                "2012/9/21 14:25",
                "2012/9/21 14:30",
                "2012/9/21 14:30",
                "2012/9/21 14:30",
                "2012/9/21 14:40",
                "2012/9/21 14:50",
                "2012/9/21 14:55",
                "2012/9/21 14:55",
                "2012/9/21 15:00",
                "2012/9/21 15:00",
                "2012/9/21 15:00",
                "2012/9/21 15:05",
                "2012/9/21 15:15",
                "2012/9/21 15:25",
                "2012/9/21 15:30",
                "2012/9/21 15:30",
                "2012/9/21 15:40",
                "2012/9/21 15:45",
                "2012/9/21 15:45",
                "2012/9/21 15:50",
                "2012/9/21 15:50",
                "2012/9/21 15:55",
                "2012/9/21 15:55",
                "2012/9/21 16:00",
                "2012/9/21 16:00",
                "2012/9/21 16:05",
                "2012/9/21 16:15",
                "2012/9/21 16:15",
                "2012/9/21 16:15",
                "2012/9/21 16:20",
                "2012/9/21 16:20",
                "2012/9/21 16:20",
                "2012/9/21 16:20",
                "2012/9/21 16:20",
                "2012/9/21 16:30",
                "2012/9/21 16:35",
                "2012/9/21 17:00",
                "2012/9/21 17:00",
                "2012/9/21 17:05",
                "2012/9/21 17:10",
                "2012/9/21 17:10",
                "2012/9/21 17:20",
                "2012/9/21 17:20",
                "2012/9/21 17:25",
                "2012/9/21 17:25",
                "2012/9/21 17:30",
                "2012/9/21 17:40",
                "2012/9/21 17:45",
                "2012/9/21 17:45",
                "2012/9/21 17:50",
                "2012/9/21 17:55",
                "2012/9/21 18:00",
                "2012/9/21 18:00",
                "2012/9/21 18:00",
                "2012/9/21 18:00",
                "2012/9/21 18:05",
                "2012/9/21 18:05",
                "2012/9/21 18:10",
                "2012/9/21 18:10",
                "2012/9/21 18:15",
                "2012/9/21 18:15",
                "2012/9/21 18:25",
                "2012/9/21 18:25",
                "2012/9/21 18:25",
                "2012/9/21 18:30",
                "2012/9/21 18:30",
                "2012/9/21 18:35",
                "2012/9/21 18:40",
                "2012/9/21 18:45",
                "2012/9/21 18:45",
                "2012/9/21 19:00",
                "2012/9/21 19:00",
                "2012/9/21 19:00",
                "2012/9/21 19:00",
                "2012/9/21 19:00",
                "2012/9/21 19:05",
                "2012/9/21 19:10",
                "2012/9/21 19:10",
                "2012/9/21 19:15",
                "2012/9/21 19:25",
                "2012/9/21 19:25",
                "2012/9/21 19:25",
                "2012/9/21 19:30",
                "2012/9/21 19:35",
                "2012/9/21 19:40",
                "2012/9/21 19:45",
                "2012/9/21 19:50",
                "2012/9/21 19:50",
                "2012/9/21 19:50",
                "2012/9/21 19:55",
                "2012/9/21 20:00",
                "2012/9/21 20:00",
                "2012/9/21 20:10",
                "2012/9/21 20:10",
                "2012/9/21 20:15",
                "2012/9/21 20:15",
                "2012/9/21 20:20",
                "2012/9/21 20:25",
                "2012/9/21 20:30",
                "2012/9/21 20:30",
                "2012/9/21 20:35",
                "2012/9/21 20:40",
                "2012/9/21 21:00",
                "2012/9/21 21:00",
                "2012/9/21 21:05",
                "2012/9/21 21:15",
                "2012/9/21 21:15",
                "2012/9/21 21:15",
                "2012/9/21 21:30",
                "2012/9/21 21:30",
                "2012/9/21 21:40",
                "2012/9/21 21:45",
                "2012/9/21 21:50",
                "2012/9/21 21:50",
                "2012/9/21 21:55",
                "2012/9/21 22:00",
                "2012/9/21 22:00",
                "2012/9/21 22:00",
                "2012/9/21 22:00",
                "2012/9/21 22:05",
                "2012/9/21 22:05",
                "2012/9/21 22:10",
                "2012/9/21 22:10",
                "2012/9/21 22:15",
                "2012/9/21 22:15",
                "2012/9/21 22:15",
                "2012/9/21 22:15",
                "2012/9/21 22:25",
                "2012/9/21 22:25",
                "2012/9/21 22:40",
                "2012/9/21 22:55",
                "2012/9/21 23:00",
                "2012/9/21 23:05",
                "2012/9/21 23:05",
                "2012/9/21 23:20",
                "2012/9/21 23:40",
                "2012/9/22 0:10",
                "2012/9/22 0:30",
                "2012/9/22 0:55",
                "2012/9/22 1:00",
                "2012/9/22 1:00",
                "2012/9/22 1:20",
                "2012/9/22 1:30",
                "2012/9/22 2:05",
                "2012/9/22 2:10",
                "2012/9/22 2:30",
                "2012/9/22 2:45",
                "2012/9/22 6:10",
                "2012/9/22 6:40",
                "2012/9/22 6:40"};

        String[] array1 = {
                "2012/9/21 6:45",
                "2012/9/21 6:45",
                "2012/9/21 6:45",
                "2012/9/21 6:50",
                "2012/9/21 6:50",
                "2012/9/21 6:55",
                "2012/9/21 7:25",
                "2012/9/21 7:30",
                "2012/9/21 7:40",
                "2012/9/21 7:40",
                "2012/9/21 7:40",
                "2012/9/21 7:45",
                "2012/9/21 7:45",
                "2012/9/21 7:50",
                "2012/9/21 7:50",
                "2012/9/21 7:50",
                "2012/9/21 7:55",
                "2012/9/21 8:00",
                "2012/9/21 8:00",
                "2012/9/21 8:20",
                "2012/9/21 8:20",
                "2012/9/21 8:20",
                "2012/9/21 8:25",
                "2012/9/21 8:25",
                "2012/9/21 8:30",
                "2012/9/21 8:40",
                "2012/9/21 8:40",
                "2012/9/21 8:50",
                "2012/9/21 8:50",
                "2012/9/21 9:05",
                "2012/9/21 9:05",
                "2012/9/21 9:35",
                "2012/9/21 9:45",
                "2012/9/21 9:55",
                "2012/9/21 10:45",
                "2012/9/21 11:35",
                "2012/9/21 12:30",
                "2012/9/21 12:45",
                "2012/9/21 12:50",
                "2012/9/21 12:50",
                "2012/9/21 13:05",
                "2012/9/21 13:15",
                "2012/9/21 13:20",
                "2012/9/21 13:30",
                "2012/9/21 13:40",
                "2012/9/21 13:50",
                "2012/9/21 14:45",
                "2012/9/21 14:55",
                "2012/9/21 15:05",
                "2012/9/21 15:10",
                "2012/9/21 15:30",
                "2012/9/21 15:30",
                "2012/9/21 15:40",
                "2012/9/21 16:25",
                "2012/9/21 16:50",
                "2012/9/21 17:00",
                "2012/9/21 17:10",
                "2012/9/21 17:15",
                "2012/9/21 17:15",
                "2012/9/21 17:40",
                "2012/9/21 18:05",
                "2012/9/21 19:05",
                "2012/9/21 19:05",
                "2012/9/21 19:40",
                "2012/9/21 20:00",
                "2012/9/21 20:05",
                "2012/9/21 20:05",
                "2012/9/21 20:10",
                "2012/9/21 20:20",
                "2012/9/21 20:30",
                "2012/9/21 21:10",
                "2012/9/21 21:10",
                "2012/9/21 21:10",
                "2012/9/21 21:20",
                "2012/9/21 21:20",
                "2012/9/21 21:25",
                "2012/9/21 22:00",
                "2012/9/21 22:05",
                "2012/9/21 22:10",
                "2012/9/21 22:15",
                "2012/9/21 23:30"
        };
        return array1;
    }

    /**
     * 时间段，可以修改两次相差的时间
     * @param time
     * @return
     */
    private static long getAfterAnHour(Date time) {
        return time.getTime() + 30 * 60 * 1000;
    }


    static class Gas{
        /**
         * 便于区分第几条数据
         */
        private Integer id;
        /**
         * 传入的时间
         */
        private Date time;
        /**
         * 该条数据是否可用
         */
        private Integer isAble;

        public Integer getId() {
            return id;
        }

        public void setId(Integer id) {
            this.id = id;
        }

        public Date getTime() {
            return time;
        }

        public void setTime(Date time) {
            this.time = time;
        }

        public Integer getIsAble() {
            return isAble;
        }

        public void setIsAble(Integer isAble) {
            this.isAble = isAble;
        }

        public Gas(Integer id, Date time, Integer isAble) {
            this.id = id;
            this.time = time;
            this.isAble = isAble;
        }
    }
}

